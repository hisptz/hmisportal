<div class="container-fluid">
  <h5 class="text-center">{{ menu.name }}</h5>
  <input
    class="form-control form-control-sm p-1"
    [value]="menu.name"
    (input)="updateName($event.target.value, menu)"
  >
  <div class="row">

    <div class="col-sm-7">
      <div class="row">
        <div class="col-sm-12">
          <button class="btn btn-sm btn-outline-secondary pull-right mt-2 cursor" (click)="addIndicator(menu)">Add Indicator</button>
        </div>
      </div>
      <ul class="list-group"  *ngIf="menu.has_submenu"
          dnd-sortable-container [sortableData]="menu.submenus">
        <li
          *ngFor="let menuItem of menu.submenus;trackBy: trackItem;let i = index"
          class="list-group-item m-1 p-1"
          [ngClass]="{'active':editing[menuItem.id] || (submenu && submenu.id == menuItem.id)}"
          dnd-sortable
          [dragEnabled]="!editing[menuItem.id]"
          [sortableIndex]="i"
          (onDropSuccess)="onDropSuccess(menu)"
        >
          <div class="row">
            <div class="col-sm-10 pt-2" @fadeInOut *ngIf="!editing[menuItem.id]">
              <button class="btn btn-link" title="drag to order menu">
                <i class="fa fa-bars" style="cursor: all-scroll"></i>
              </button>
              {{ menuItem.name }}
            </div>
            <div class="col-sm-10" @fadeInOut *ngIf="editing[menuItem.id]">
              <input
                [value]="menuItem.name"
                class="form-control"
                (input)="updateName($event.target.value, menuItem)"
              >
            </div>
            <div class="col-sm-10" @fadeInOut *ngIf="deleting[menuItem.id]">
              Are you sure you want to delete this menu and all associated data?
              <button
                class="btn btn-outline-success btn-sm cursor pull-right mr-1"
                (click)="deleteMenu(menuItem, menu)"
              ><i class="fa fa-check"></i>
              </button><button
                class="btn btn-outline-warning btn-sm cursor pull-right mr-1"
                (click)="deleting[menuItem.id] = false"
              ><i class="fa fa-times"></i>
              </button>
            </div>
            <div class="col-sm-2 pt-2">
              <button
                class="btn btn-outline-primary btn-sm cursor pull-right mr-1"
                *ngIf="!editing[menuItem.id] && !deleting[menuItem.id]"
                (click)="enableEdit(menuItem)"
                @fadeInOut
              >
                <i class="fa fa-pencil"></i>
              </button>
              <button
                class="btn btn-outline-primary btn-sm cursor pull-right mr-1"
                *ngIf="!editing[menuItem.id] && !deleting[menuItem.id] && menuItem.submenusId.length == 0"
                (click)="addIndicator(menuItem, true)"
                title="add submenu"
                @fadeInOut
              >
                <i class="fa fa-plus"></i>
              </button>
              <button
                class="btn btn-outline-danger btn-sm cursor pull-right mr-1"
                *ngIf="!editing[menuItem.id] && !deleting[menuItem.id]"
                (click)="enableDeleteMenu(menuItem)"
                @fadeInOut
              >
                <i class="fa fa-trash-o"></i>
              </button>
              <button
                class="btn btn-outline-success btn-sm cursor pull-right mr-1"
                *ngIf="editing[menuItem.id]"
                (click)="editing[menuItem.id] = false"
                @fadeInOut
              >
                <i class="fa fa-check"></i>
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>

    <div class="col-sm-5 pl-0" *ngIf="submenu">
      <div class="row">
        <div class="col-sm-12">
          <button class="btn btn-sm btn-outline-secondary pull-right mt-2 cursor" (click)="addIndicator(submenu)">Add Indicator</button>
        </div>
      </div>
      <ul class="list-group"
          *ngIf="submenu.has_submenu"
          dnd-sortable-container [sortableData]="submenu.submenus">
        <li
          *ngFor="let menuItem of submenu.submenus;trackBy: trackItem;let i = index"
          class="list-group-item m-1 p-1"
          [ngClass]="{'active':editing[menuItem.id]}"
          dnd-sortable
          [dragEnabled]="!editing[menuItem.id]"
          [sortableIndex]="i"
          (onDropSuccess)="onDropSuccess(submenu)"
        >
          <div class="row">
            <div class="col-sm-10 pt-2" @fadeInOut *ngIf="!editing[menuItem.id]">
              <button class="btn btn-link" title="drag to order menu">
                <i class="fa fa-bars" style="cursor: all-scroll"></i>
              </button>
              {{ menuItem.name }}
            </div>
            <div class="col-sm-10" @fadeInOut *ngIf="editing[menuItem.id]">
              <input
                [value]="menuItem.name"
                class="form-control"
                (input)="updateName($event.target.value, menuItem)"
              >
            </div>
            <div class="col-sm-10" @fadeInOut *ngIf="deleting[menuItem.id]">
              Are you sure you want to delete this menu and all associated data?
              <button
                class="btn btn-outline-success btn-sm cursor pull-right mr-1"
                (click)="deleteMenu(menuItem)"
              ><i class="fa fa-check"></i>
              </button><button
              class="btn btn-outline-warning btn-sm cursor pull-right mr-1"
              (click)="deleting[menuItem.id] = false"
            ><i class="fa fa-times"></i>
            </button>
            </div>
            <div class="col-sm-2">
              <button
                class="btn btn-outline-secondary btn-sm cursor pull-right mr-1"
                *ngIf="!editing[menuItem.id]"
                (click)="enableEdit(menuItem, false)"
                @fadeInOut
              >
                <i class="fa fa-pencil"></i>
              </button>
              <button
                class="btn btn-outline-danger btn-sm cursor pull-right mr-1"
                *ngIf="!editing[menuItem.id]"
                (click)="enableDeleteMenu(menuItem)"
                @fadeInOut
              >
                <i class="fa fa-trash-o"></i>
              </button>
              <button
                class="btn btn-outline-secondary btn-sm cursor pull-right mr-1"
                *ngIf="editing[menuItem.id]"
                (click)="editing[menuItem.id] = false"
                @fadeInOut
              >
                <i class="fa fa-check"></i>
              </button>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <div class="row" *ngIf="!menu.has_submenu">
    <div class="col-sm-12">
      <p class="text-center lead pt-5 text-muted">This menu has no submenus</p>
    </div>
  </div>
</div>

